
R version 3.5.0 (2018-04-23) -- "Joy in Playing"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # load libraries
> library(tidyverse)
â”€â”€ [1mAttaching packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.2.1 â”€â”€
[32mâœ”[39m [34mggplot2[39m 3.0.0     [32mâœ”[39m [34mpurrr  [39m 0.2.5
[32mâœ”[39m [34mtibble [39m 1.4.2     [32mâœ”[39m [34mdplyr  [39m 0.7.6
[32mâœ”[39m [34mtidyr  [39m 0.8.1     [32mâœ”[39m [34mstringr[39m 1.3.1
[32mâœ”[39m [34mreadr  [39m 1.1.1     [32mâœ”[39m [34mforcats[39m 0.3.0
â”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
[31mâœ–[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31mâœ–[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
> library(reshape2)

Attaching package: â€˜reshape2â€™

The following object is masked from â€˜package:tidyrâ€™:

    smiths

> library(cowplot)

Attaching package: â€˜cowplotâ€™

The following object is masked from â€˜package:ggplot2â€™:

    ggsave

> 
> # load data
> load('data/aos_wgcna.rda')
> 
> # global variables
> figures_dir = 'manuscript/figures'
> 
> # generate figure
> 
> (plot_grid(sft$fitIndices %>%
+              mutate(y = -sign(slope)*SFT.R.sq) %>%
+              ggplot(aes(x = Power, y = y)) +
+              geom_point() +
+              geom_hline(yintercept = 0.39, lty = 2, color = 'red') +
+              labs(x = 'Soft Thresold (power)',
+                   y = 'Scale-Free Topology') +
+              theme_bw(),
+            sft$fitIndices %>%
+              ggplot(aes(x = Power, y = `mean.k.`)) +
+              geom_point() +
+              geom_vline(xintercept = 5, lty = 2, color = 'red') +
+              labs(x = 'Soft Threshold (power)',
+                   y = 'Mean Connectivity') +
+              theme_bw(),
+            labels = 'AUTO',
+            label_size = 10,
+            label_fontface = 'plain',
+            nrow = 1,
+            scale = .9)) %>%
+   ggsave(plot = .,
+          filename = paste(figures_dir, 'sft_power.png', sep = '/'),
+          width = 16, height = 7, units = 'cm')
> 
> proc.time()
   user  system elapsed 
  1.490   0.230   1.656 
