
R version 3.5.0 (2018-04-23) -- "Joy in Playing"
Copyright (C) 2018 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # load libraries
> library(tidyverse)
â”€â”€ [1mAttaching packages[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.2.1 â”€â”€
[32mâœ”[39m [34mggplot2[39m 3.0.0     [32mâœ”[39m [34mpurrr  [39m 0.2.5
[32mâœ”[39m [34mtibble [39m 1.4.2     [32mâœ”[39m [34mdplyr  [39m 0.7.6
[32mâœ”[39m [34mtidyr  [39m 0.8.1     [32mâœ”[39m [34mstringr[39m 1.3.1
[32mâœ”[39m [34mreadr  [39m 1.1.1     [32mâœ”[39m [34mforcats[39m 0.3.0
â”€â”€ [1mConflicts[22m â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€
[31mâœ–[39m [34mdplyr[39m::[32mfilter()[39m masks [34mstats[39m::filter()
[31mâœ–[39m [34mdplyr[39m::[32mlag()[39m    masks [34mstats[39m::lag()
> library(aos)
> library(org.Hs.eg.db)
Loading required package: AnnotationDbi
Loading required package: stats4
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: â€˜BiocGenericsâ€™

The following objects are masked from â€˜package:parallelâ€™:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following objects are masked from â€˜package:dplyrâ€™:

    combine, intersect, setdiff, union

The following objects are masked from â€˜package:statsâ€™:

    IQR, mad, sd, var, xtabs

The following objects are masked from â€˜package:baseâ€™:

    anyDuplicated, append, as.data.frame, basename, cbind, colMeans,
    colnames, colSums, dirname, do.call, duplicated, eval, evalq,
    Filter, Find, get, grep, grepl, intersect, is.unsorted, lapply,
    lengths, Map, mapply, match, mget, order, paste, pmax, pmax.int,
    pmin, pmin.int, Position, rank, rbind, Reduce, rowMeans, rownames,
    rowSums, sapply, setdiff, sort, table, tapply, union, unique,
    unsplit, which, which.max, which.min

Loading required package: Biobase
Welcome to Bioconductor

    Vignettes contain introductory material; view with
    'browseVignettes()'. To cite Bioconductor, see
    'citation("Biobase")', and for packages 'citation("pkgname")'.

Loading required package: IRanges
Loading required package: S4Vectors

Attaching package: â€˜S4Vectorsâ€™

The following objects are masked from â€˜package:dplyrâ€™:

    first, rename

The following object is masked from â€˜package:tidyrâ€™:

    expand

The following object is masked from â€˜package:baseâ€™:

    expand.grid


Attaching package: â€˜IRangesâ€™

The following objects are masked from â€˜package:dplyrâ€™:

    collapse, desc, slice

The following object is masked from â€˜package:purrrâ€™:

    reduce


Attaching package: â€˜AnnotationDbiâ€™

The following object is masked from â€˜package:dplyrâ€™:

    select


> library(cgdsr)
Please send questions to cbioportal@googlegroups.com
> library(cRegulome)
> library(GEOquery)
Setting options('download.file.method.GEOquery'='auto')
Setting options('GEOquery.inmemory.gpl'=FALSE)
> 
> ## gene expression data
> url <- 'ftp://ftp.ncbi.nlm.nih.gov/geo/series/GSE104nnn/GSE104664/suppl/GSE104664%5Fcounts%5FtotalRNA%2Etxt%2Egz'
> 
> if(!file.exists('GSE104664_counts_totalRNA.txt.gz')) {
+   download.file(url,
+                 destfile = 'data/GSE104664_counts_totalRNA.txt.gz')
+ }
trying URL 'ftp://ftp.ncbi.nlm.nih.gov/geo/series/GSE104nnn/GSE104664/suppl/GSE104664%5Fcounts%5FtotalRNA%2Etxt%2Egz'
Content type 'unknown' length 621210 bytes (606 KB)
==================================================
> 
> ## annotation data
> if(!file.exists('data/annotations.tsv')) {
+   ann <- annotation_get(
+     go_id = c('GO:0006979', 'GO:0006914'),
+     go_names = c('oxidative_stress', 'autophagy'),
+     org_db = org.Hs.eg.db,
+     columns = 'SYMBOL',
+     remove_predicted = FALSE
+   )
+ 
+   write_tsv(ann, 'data/annotations.tsv')
+ }
> 
> if(!file.exists('data/interactions_evidence.tsv')) {
+   ann <- read_tsv('data/annotations.tsv')
+   interactions_get(genes = data.frame(symbol = unique(ann$symbol)),
+                    input_directory = 'data', evidence = TRUE) %>%
+     write_tsv('data/interactions_evidence.tsv')
+ }
> 
> gse <- c('GSE87666', 'GSE55696', 'GSE78523')
> map(gse, function(x) {
+   if(!file.exists(paste('data', x, '_series_matrix.txt.gz', sep = '/'))) {
+     getGEO(x,
+            destdir = 'data/')
+   }
+ })
Found 1 file(s)
GSE87666_series_matrix.txt.gz
Using locally cached version: data//GSE87666_series_matrix.txt.gz
Parsed with column specification:
cols(
  .default = col_double(),
  ID_REF = col_character()
)
See spec(...) for full column specifications.
Using locally cached version of GPL17077 found here:
data//GPL17077.soft 
Found 1 file(s)
GSE55696_series_matrix.txt.gz
Using locally cached version: data//GSE55696_series_matrix.txt.gz
Parsed with column specification:
cols(
  .default = col_double(),
  ID_REF = col_character()
)
See spec(...) for full column specifications.
Using locally cached version of GPL6480 found here:
data//GPL6480.soft 
Warning: 94 parsing failures.
row [90m# A tibble: 5 x 5[39m col     row col          expected           actual file         expected   [3m[90m<int>[39m[23m [3m[90m<chr>[39m[23m        [3m[90m<chr>[39m[23m              [3m[90m<chr>[39m[23m  [3m[90m<chr>[39m[23m        actual [90m1[39m [4m4[24m[4m1[24m001 CONTROL_TYPE 1/0/T/F/TRUE/FALSE pos    literal data file [90m2[39m [4m4[24m[4m1[24m002 CONTROL_TYPE 1/0/T/F/TRUE/FALSE pos    literal data row [90m3[39m [4m4[24m[4m1[24m003 CONTROL_TYPE 1/0/T/F/TRUE/FALSE pos    literal data col [90m4[39m [4m4[24m[4m1[24m004 CONTROL_TYPE 1/0/T/F/TRUE/FALSE pos    literal data expected [90m5[39m [4m4[24m[4m1[24m005 CONTROL_TYPE 1/0/T/F/TRUE/FALSE pos    literal data
... ........................... ... ........................................................... ........ ................................................................................................................................................. [... truncated]
Found 1 file(s)
GSE78523_series_matrix.txt.gz
Using locally cached version: data//GSE78523_series_matrix.txt.gz
Parsed with column specification:
cols(
  .default = col_double(),
  ID_REF = col_character()
)
See spec(...) for full column specifications.
Using locally cached version of GPL18990 found here:
data//GPL18990.soft 
[[1]]
[[1]]$GSE87666_series_matrix.txt.gz
ExpressionSet (storageMode: lockedEnvironment)
assayData: 50656 features, 22 samples 
  element names: exprs 
protocolData: none
phenoData
  sampleNames: GSM2338004 GSM2338005 ... GSM2338025 (22 total)
  varLabels: title geo_accession ... tissue:ch1 (40 total)
  varMetadata: labelDescription
featureData
  featureNames: (+)E1A_r60_1 (+)E1A_r60_3 ... ETG10_236652 (50656
    total)
  fvarLabels: ID SPOT_ID ... SEQUENCE (16 total)
  fvarMetadata: Column Description labelDescription
experimentData: use 'experimentData(object)'
Annotation: GPL17077 


[[2]]
[[2]]$GSE55696_series_matrix.txt.gz
ExpressionSet (storageMode: lockedEnvironment)
assayData: 36765 features, 77 samples 
  element names: exprs 
protocolData: none
phenoData
  sampleNames: GSM1341860 GSM1341861 ... GSM1341936 (77 total)
  varLabels: title geo_accession ... tissue:ch1 (37 total)
  varMetadata: labelDescription
featureData
  featureNames: (+)E1A_r60_1 (+)E1A_r60_3 ... RC9 (36765 total)
  fvarLabels: ID SPOT_ID ... SEQUENCE (17 total)
  fvarMetadata: Column Description labelDescription
experimentData: use 'experimentData(object)'
Annotation: GPL6480 


[[3]]
[[3]]$GSE78523_series_matrix.txt.gz
ExpressionSet (storageMode: lockedEnvironment)
assayData: 110425 features, 45 samples 
  element names: exprs 
protocolData: none
phenoData
  sampleNames: GSM2072175 GSM2072176 ... GSM2072219 (45 total)
  varLabels: title geo_accession ... tissue:ch1 (39 total)
  varMetadata: labelDescription
featureData
  featureNames: 200000_s_at 200001_at ... AFFX-TrpnX-M_at (110425
    total)
  fvarLabels: ID GeneChip Array ... Annotation Notes (33 total)
  fvarMetadata: Column Description labelDescription
experimentData: use 'experimentData(object)'
Annotation: GPL18990 


Warning message:
In rbind(names(probs), probs_f) :
  number of columns of result is not a multiple of vector length (arg 1)
> 
> proc.time()
   user  system elapsed 
 29.910   1.830  42.592 
